FROM centos:7.0.1406
MAINTAINER Jean Gabes <naparuba@gmail.com>

# NOTE: old centos versions have issues with docker overlay
# => Rpmdb checksum is invalid: dCDPT(pkg checksums):
ADD        test/docker-helper/  /
RUN        /yum_install yum-plugin-ovl

# TCL: very little
ENV        TEST_PACKAGE_NAME=tcl
# centos have a virtual package to test, vi -> vim-minimal
ENV        TEST_PACKAGE_NAME_VIRTUAL=vi
# But need to delete it first as it is installed by default
RUN        /yum_remove vim-minimal

ADD        . /root/opsbro-oss

WORKDIR    /root/opsbro-oss


# centos7.0 and 7.1 have a unstable sqlite lib
ENV        SKIP_SQLITE=TRUE


ENTRYPOINT        test/test_one_linux_installation.sh  && test/assert_group.sh "centos"


